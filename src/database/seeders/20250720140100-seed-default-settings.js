'use strict';

module.exports = {
  async up(queryInterface, Sequelize) {
    const now = new Date();
    
    // Default pricing settings - simplified structure
    await queryInterface.bulkInsert('business_settings', [
      // Lease pricing - per KG system
      {
        category_id: 2,
        setting_key: 'lease.fee_per_kg',
        setting_value: JSON.stringify(1000),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'LEASE',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 2,
        setting_key: 'lease.deposit_per_kg',
        setting_value: JSON.stringify(500),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'LEASE',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      
      // Return penalty settings - based on cylinder condition
      {
        category_id: 2,
        setting_key: 'return.penalty.good',
        setting_value: JSON.stringify(0),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'LEASE',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 2,
        setting_key: 'return.penalty.poor',
        setting_value: JSON.stringify(500),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'LEASE',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 2,
        setting_key: 'return.penalty.damaged',
        setting_value: JSON.stringify(2000),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'LEASE',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      
      // Refill pricing
      {
        category_id: 3,
        setting_key: 'refill.price_per_kg',
        setting_value: JSON.stringify(10),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'REFILL',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 3,
        setting_key: 'refill.minimum_charge',
        setting_value: JSON.stringify(50),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'REFILL',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      
      // Swap pricing - based on cylinder condition
      {
        category_id: 4,
        setting_key: 'swap.fee.good',
        setting_value: JSON.stringify(0),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'SWAP',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 4,
        setting_key: 'swap.fee.poor',
        setting_value: JSON.stringify(200),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'SWAP',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 4,
        setting_key: 'swap.fee.damaged',
        setting_value: JSON.stringify(500),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: 'SWAP',
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      
      // General settings
      {
        category_id: 10,
        setting_key: 'tax.rate',
        setting_value: JSON.stringify(7.5),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: null,
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 10,
        setting_key: 'tax.type',
        setting_value: JSON.stringify('exclusive'),
        data_type: 'string',
        outlet_id: null,
        cylinder_type: null,
        operation_type: null,
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 10,
        setting_key: 'late.fee.daily',
        setting_value: JSON.stringify(10),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: null,
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      
      // Business rules
      {
        category_id: 8,
        setting_key: 'business.max_active_leases_per_customer',
        setting_value: JSON.stringify(5),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: null,
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
      {
        category_id: 8,
        setting_key: 'business.inventory_low_threshold',
        setting_value: JSON.stringify(10),
        data_type: 'number',
        outlet_id: null,
        cylinder_type: null,
        operation_type: null,
        is_active: true,
        created_by: 1,
        updated_by: 1,
        created_at: now,
        updated_at: now,
      },
    ], {});
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.bulkDelete('business_settings', null, {});
  }
};